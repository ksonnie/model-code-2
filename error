import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression, ElasticNet
from sklearn.ensemble import GradientBoostingRegressor
from sklearn.tree import DecisionTreeRegressor
from xgboost import XGBRegressor

# File path and relevant BSO sheets
file_path = "/Volumes/navy-fip4-ya-dev/data_cleansing_dev/visualization_dev/All BSOs Dashboards.xlsx"
bso_sheets = {
   'USFFC': 'FFC Proj',
   'RESFOR': 'RESFOR Proj',
   'PACFLT': 'PACFLT Proj'
}

# Dictionary specifying BSO, KPI, and model
model_mapping = {
    ('USFFC', 'NULOs that Remain High Priority'): 'XGBoost Regressor',
    ('USFFC', 'Billing exceeds Authorization (Abnormal Unfilled Customer Orders)'): 'Gradient Boosting',
    ('RESFOR', 'RBC Level - Total Negative Billed'): 'Decision Tree',
    ('PACFLT', 'Non-Labor Duplicates on SDN/ACRN/CLIN/SLIN'): 'Linear Regression',
    ('PACFLT', 'Cost Transfer Allocation - "L"'): 'ElasticNet(alpha=0.1)',
}

# Function to replace NA with zeros
def replace_na_with_zeros(df):
    return df.fillna(0)
