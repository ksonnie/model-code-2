# Collect results in a consolidated DataFrame
def consolidate_results(predictions_by_bso):
    consolidated_data = []
    for bso, data in predictions_by_bso.items():
        data['BSO'] = bso  # Add a BSO column to the DataFrame
        consolidated_data.append(data)
    # Combine all data into a single DataFrame
    consolidated_df = pd.concat(consolidated_data, ignore_index=True)
    return consolidated_df

# Main section to process and display results
updated_bso_data = process_bso_sheets(file_path, bso_sheets, all_results)

# Consolidate all results into a single DataFrame
consolidated_results = consolidate_results(updated_bso_data)

# Display the results in a tabular format
import ace_tools as tools  # Use ace_tools for a better table view
tools.display_dataframe_to_user(name="Predicted KPI Results", dataframe=consolidated_results)
