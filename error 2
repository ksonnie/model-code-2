import pandas as pd
from openpyxl import load_workbook

# Step 1: Load the BSO_Proj.csv file into a DataFrame
bso_proj_df = pd.read_csv("/Volumes/navy-fip4-ya-dev/data_cleansing_dev/visualization_dev/BSO_Proj.csv")

# Step 2: Define the path of the original Excel file and the new Excel file
excel_path = "/Volumes/navy-fip4-ya-dev/data_cleansing_dev/visualization_dev/All BSOs Dashboards.xlsx"
new_excel_path = "/Volumes/navy-fip4-ya-dev/data_cleansing_dev/visualization_dev/All Bso file output/All BSOs Dashboards Updated.xlsx"

# Step 3: Load the existing Excel file using openpyxl
workbook = load_workbook(excel_path)

# Step 4: Append the new sheet 'BSO_Proj' to the workbook
# Create a new Excel file with the same content as the original workbook
with pd.ExcelWriter(new_excel_path, engine='openpyxl') as excel_writer:
    # Write each existing sheet to the new Excel file
    for sheet_name in workbook.sheetnames:
        sheet_data = pd.read_excel(excel_path, sheet_name=sheet_name)
        sheet_data.to_excel(excel_writer, sheet_name=sheet_name, index=False)

    # Step 5: Add the new sheet (BSO_Proj) with data from the CSV
    bso_proj_df.to_excel(excel_writer, sheet_name='BSO_Proj', index=False)

# Step 6: Save the updated Excel file
print(f"Updated Excel file saved to {new_excel_path}")
